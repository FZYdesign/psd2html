<!DOCTYPE html>  <html> <head>   <title>core</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="ControlUI.class.html">                 ControlUI.class.coffee               </a>                                           <a class="source" href="DialogUI.class.html">                 DialogUI.class.coffee               </a>                                           <a class="source" href="WindowUI.class.html">                 WindowUI.class.coffee               </a>                                           <a class="source" href="core.html">                 core.coffee               </a>                                           <a class="source" href="include_libraries.html">                 include_libraries.coffee               </a>                                           <a class="source" href="main.html">                 main.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               core             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="s">&#39;use strict&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <h2>Constants</h2>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">NAMESPACE = </span><span class="s">&#39;psd2html&#39;</span>
<span class="nv">VERSION = </span><span class="s">&#39;1.1.0&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <h2>Alias</h2>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">global = </span><span class="nx">@</span>
<span class="nb">Math</span> <span class="o">=</span> <span class="nx">global</span><span class="p">.</span><span class="nb">Math</span>
<span class="nv">setTimeout = </span><span class="nx">global</span><span class="p">.</span><span class="nx">setTimeout</span>
<span class="nv">clearTimeout = </span><span class="nx">global</span><span class="p">.</span><span class="nx">clearTimeout</span>
<span class="nv">setInterval = </span><span class="nx">global</span><span class="p">.</span><span class="nx">setInterval</span>
<span class="nv">clearInterval = </span><span class="nx">global</span><span class="p">.</span><span class="nx">clearInterval</span>
<span class="nb">isNaN</span> <span class="o">=</span> <span class="nx">global</span><span class="p">.</span><span class="nb">isNaN</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <h2>Variables</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <h2>Functions</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <h3>Debug Function</h3>

<h4>ハッシュの出力用（再帰なし）</h4>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">varDump = </span><span class="nf">(obj) -&gt;</span>
  <span class="nv">_rlt = </span><span class="p">[]</span>
  <span class="k">for</span> <span class="k">own</span> <span class="nx">_key</span> <span class="k">of</span> <span class="nx">obj</span>
    <span class="k">try</span>
      <span class="nv">_val = </span><span class="nx">obj</span><span class="p">[</span><span class="nx">_key</span><span class="p">]</span>
      <span class="k">unless</span> <span class="nx">_val</span> <span class="k">instanceof</span> <span class="nb">Function</span> <span class="k">then</span> <span class="nx">_rlt</span><span class="p">.</span><span class="nx">push</span> <span class="nx">_key</span> <span class="o">+</span> <span class="s">&#39;: &#39;</span> <span class="o">+</span> <span class="nx">_val</span>
    <span class="k">catch</span> <span class="nx">error</span>
  <span class="nx">alert</span> <span class="nx">_rlt</span><span class="p">.</span><span class="nx">join</span> <span class="s">&#39;\n&#39;</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <h3>Utility Function</h3>

<h4>数値処理拡張</h4>             </td>             <td class="code">               <div class="highlight"><pre><span class="nb">Number</span><span class="o">::</span><span class="nv">fillZero = </span><span class="nf">(n) -&gt;</span>
  <span class="nv">zeros = </span><span class="k">new</span> <span class="nb">Array</span> <span class="nx">n</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="nx">@toString</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="nx">length</span>
  <span class="nx">zeros</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s">&#39;0&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">@</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <h3>Layer Function</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <h4>全レイヤーを選択</h4>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">selectAllLayers = </span><span class="nf">-&gt;</span>
  <span class="nv">ref = </span><span class="k">new</span> <span class="nx">ActionReference</span><span class="p">()</span>
  <span class="nx">ref</span><span class="p">.</span><span class="nx">putEnumerated</span> <span class="nx">charIDToTypeID</span><span class="p">(</span><span class="s">&#39;Lyr &#39;</span><span class="p">),</span> <span class="nx">charIDToTypeID</span><span class="p">(</span><span class="s">&#39;Ordn&#39;</span><span class="p">),</span> <span class="nx">charIDToTypeID</span><span class="p">(</span><span class="s">&#39;Trgt&#39;</span><span class="p">)</span>
  <span class="nv">desc = </span><span class="k">new</span> <span class="nx">ActionDescriptor</span><span class="p">()</span>
  <span class="nx">desc</span><span class="p">.</span><span class="nx">putReference</span> <span class="nx">charIDToTypeID</span><span class="p">(</span><span class="s">&#39;null&#39;</span><span class="p">),</span> <span class="nx">ref</span>
  <span class="nx">executeAction</span> <span class="nx">stringIDToTypeID</span><span class="p">(</span><span class="s">&#39;selectAllLayers&#39;</span><span class="p">),</span> <span class="nx">desc</span><span class="p">,</span> <span class="nx">DialogModes</span><span class="p">.</span><span class="nx">NO</span>
  <span class="k">return</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <h4>レイヤーのコピー</h4>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">cloneLayer = </span><span class="nf">(layer, removeCOPYText) -&gt;</span>
  <span class="nv">removeCOPY = </span><span class="nf">(layer) -&gt;</span>
    <span class="nv">layer.name = </span><span class="nx">layer</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">replace</span> <span class="sr">/\s+のコピー(?:\s+\d+)?$/</span><span class="p">,</span> <span class="s">&#39;&#39;</span>
    <span class="k">if</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">layers</span>
      <span class="k">for</span> <span class="nx">child</span> <span class="k">in</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">layers</span>
        <span class="nx">removeCOPY</span> <span class="nx">child</span>
  <span class="nv">newLayer = </span><span class="nx">layer</span><span class="p">.</span><span class="nx">duplicate</span><span class="p">()</span>
  <span class="nx">removeCOPY</span> <span class="nx">newLayer</span> <span class="k">if</span> <span class="nx">removeCOPYText</span>
  <span class="nv">activeDocument.activeLayer = </span><span class="nx">newLayer</span>
  <span class="nx">newLayer</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <h4>スマートオブジェクトに変更</h4>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">toSmartObject = </span><span class="nf">(layer) -&gt;</span>
  <span class="k">if</span> <span class="nx">layer</span><span class="o">?</span>
    <span class="nv">activeDocument.activeLayer = </span><span class="nx">layer</span>
  <span class="nx">executeAction</span> <span class="nx">stringIDToTypeID</span><span class="p">(</span><span class="s">&#39;newPlacedLayer&#39;</span><span class="p">),</span> <span class="kc">undefined</span><span class="p">,</span> <span class="nx">DialogModes</span><span class="p">.</span><span class="nx">NO</span>
  <span class="nx">activeDocument</span><span class="p">.</span><span class="nx">activeLayer</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <h4>テキストの抽出</h4>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">getText = </span><span class="nf">(layer = activeDocument.layers[0]) -&gt;</span>
  <span class="nv">text = </span><span class="p">[]</span>
  <span class="nv">extructText = </span><span class="nf">(layer) -&gt;</span>
    <span class="k">if</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">layers</span>
      <span class="k">for</span> <span class="nx">child</span> <span class="k">in</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">layers</span>
        <span class="nx">extructText</span> <span class="nx">child</span>
    <span class="k">else</span> <span class="k">if</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">kind</span> <span class="o">is</span> <span class="nx">LayerKind</span><span class="p">.</span><span class="nx">TEXT</span>
      <span class="nx">text</span><span class="p">.</span><span class="nx">push</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">textItem</span><span class="p">.</span><span class="nx">contents</span>
  <span class="nx">extructText</span> <span class="nx">layer</span>
  <span class="nx">text</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <h3>FileSystem Function</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <h4>Revert</h4>

<p>復帰 (前回の保存時に戻す。)</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">revert = </span><span class="nf">-&gt;</span>
  <span class="nx">executeAction</span> <span class="nx">charIDToTypeID</span><span class="p">(</span><span class="s">&#39;Rvrt&#39;</span><span class="p">),</span> <span class="kc">undefined</span><span class="p">,</span> <span class="nx">DialogModes</span><span class="p">.</span><span class="nx">NO</span>

<span class="nv">saveJPEG = </span><span class="nf">(fileName, dir = &#39;&#39;, quality = 80) -&gt;</span>
  <span class="nv">folder = </span><span class="k">new</span> <span class="nx">Folder</span> <span class="nx">saveFolder</span> <span class="o">+</span> <span class="nx">dir</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span>
  <span class="k">unless</span> <span class="nx">folder</span><span class="p">.</span><span class="nx">exists</span>
    <span class="nx">folder</span><span class="p">.</span><span class="nx">create</span><span class="p">()</span>
  <span class="nv">filePath = </span><span class="nx">folder</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="nx">fileName</span> <span class="o">+</span> <span class="s">&#39;.jpg&#39;</span>
  <span class="nv">file = </span><span class="k">new</span> <span class="nx">File</span> <span class="nx">filePath</span>
  <span class="nv">jpegOpt = </span><span class="k">new</span> <span class="nx">JPEGSaveOptions</span><span class="p">()</span>
  <span class="nv">jpegOpt.embedColorProfile = </span><span class="kc">false</span>
  <span class="nv">jpegOpt.quality = </span><span class="nb">parseInt</span><span class="p">(</span><span class="mi">12</span> <span class="o">*</span> <span class="p">(</span><span class="nx">quality</span> <span class="o">/</span> <span class="mi">100</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
  <span class="nv">jpegOpt.formatOptions = </span><span class="nx">FormatOptions</span><span class="p">.</span><span class="nx">OPTIMIZEDBASELINE</span>
  <span class="nv">jpegOpt.scans = </span><span class="mi">3</span>
  <span class="nv">jpegOpt.matte = </span><span class="nx">MatteType</span><span class="p">.</span><span class="nx">NONE</span>
  <span class="nx">activeDocument</span><span class="p">.</span><span class="nx">saveAs</span> <span class="nx">file</span><span class="p">,</span> <span class="nx">jpegOpt</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">Extension</span><span class="p">.</span><span class="nx">LOWERCASE</span>
  <span class="nx">file</span><span class="p">.</span><span class="nx">getRelativeURI</span> <span class="nx">saveFolder</span>

<span class="nv">saveGIF = </span><span class="nf">(fileName, dir = &#39;&#39;) -&gt;</span>
  <span class="nv">folder = </span><span class="k">new</span> <span class="nx">Folder</span> <span class="nx">saveFolder</span> <span class="o">+</span> <span class="nx">dir</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span>
  <span class="k">unless</span> <span class="nx">folder</span><span class="p">.</span><span class="nx">exists</span>
    <span class="nx">folder</span><span class="p">.</span><span class="nx">create</span><span class="p">()</span>
  <span class="nv">filePath = </span><span class="nx">folder</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="nx">fileName</span> <span class="o">+</span> <span class="s">&#39;.gif&#39;</span>
  <span class="nv">file = </span><span class="k">new</span> <span class="nx">File</span> <span class="nx">filePath</span>
  <span class="nv">gifOpt = </span><span class="k">new</span> <span class="nx">GIFSaveOptions</span><span class="p">()</span>
  <span class="nv">gifOpt.colors = </span><span class="mi">32</span>
  <span class="nv">gifOpt.dither = </span><span class="nx">Dither</span><span class="p">.</span><span class="nx">NONE</span>
  <span class="nv">gifOpt.interlacted = </span><span class="kc">on</span>
  <span class="nv">gifOpt.matte = </span><span class="nx">MatteType</span><span class="p">.</span><span class="nx">WHITE</span>
  <span class="nv">gifOpt.palette = </span><span class="nx">Palette</span><span class="p">.</span><span class="nx">EXACT</span>
  <span class="nv">gifOpt.preserveExactColors = </span><span class="kc">off</span>
  <span class="nv">gifOpt.transparency = </span><span class="kc">on</span>
  <span class="nx">activeDocument</span><span class="p">.</span><span class="nx">saveAs</span> <span class="nx">file</span><span class="p">,</span> <span class="nx">gifOpt</span><span class="p">,</span> <span class="kc">on</span><span class="p">,</span> <span class="nx">Extension</span><span class="p">.</span><span class="nx">LOWERCASE</span>
  <span class="nx">file</span><span class="p">.</span><span class="nx">getRelativeURI</span> <span class="nx">saveFolder</span>

<span class="nv">savePNG = </span><span class="nf">(fileName, dir = &#39;&#39;) -&gt;</span>
  <span class="nv">folder = </span><span class="k">new</span> <span class="nx">Folder</span> <span class="nx">saveFolder</span> <span class="o">+</span> <span class="nx">dir</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span>
  <span class="k">unless</span> <span class="nx">folder</span><span class="p">.</span><span class="nx">exists</span>
    <span class="nx">folder</span><span class="p">.</span><span class="nx">create</span><span class="p">()</span>
  <span class="nv">filePath = </span><span class="nx">folder</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="nx">fileName</span> <span class="o">+</span> <span class="s">&#39;.png&#39;</span>
  <span class="nv">file = </span><span class="k">new</span> <span class="nx">File</span> <span class="nx">filePath</span>
  <span class="nv">pngOpt = </span><span class="k">new</span> <span class="nx">PNGSaveOptions</span>
  <span class="nv">pngOpt.interlaced = </span><span class="kc">off</span>
  <span class="nx">activeDocument</span><span class="p">.</span><span class="nx">saveAs</span> <span class="nx">file</span><span class="p">,</span> <span class="nx">pngOpt</span><span class="p">,</span> <span class="kc">on</span><span class="p">,</span> <span class="nx">Extension</span><span class="p">.</span><span class="nx">LOWERCASE</span>
  <span class="nx">file</span><span class="p">.</span><span class="nx">getRelativeURI</span> <span class="nx">saveFolder</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <h3>Output Function</h3>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">outputCSS = </span><span class="nf">(structures) -&gt;</span>
  <span class="nv">cssText = </span><span class="p">[</span>
    <span class="s">&quot;&quot;&quot;</span>

<span class="err">#</span><span class="s">DIVIDER</span>
<span class="s">      width: </span><span class="si">#{</span><span class="nx">pageWidth</span><span class="si">}</span><span class="s">px;</span>
<span class="s">      margin: 0 auto;</span>
<span class="s">    }</span>
<span class="s">    &quot;&quot;&quot;</span>
  <span class="p">]</span>
  <span class="k">for</span> <span class="nx">layer</span><span class="p">,</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">structures</span>
    <span class="nv">z = </span><span class="nx">i</span> <span class="o">*</span> <span class="mi">10</span>
    <span class="nv">className = </span><span class="nx">layer</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\//g</span><span class="p">,</span> <span class="s">&#39;_&#39;</span><span class="p">).</span><span class="nx">replace</span> <span class="sr">/\.[a-z]+$/i</span><span class="p">,</span> <span class="s">&#39;&#39;</span>
    <span class="nv">p = </span><span class="k">if</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">text</span><span class="p">.</span><span class="nx">length</span>
      <span class="s">&quot;&quot;&quot;</span>
<span class="s">      /*</span>
<span class="s">       * </span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">text</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span><span class="si">}</span><span class="s"></span>
<span class="s">       */</span>
<span class="s">      &quot;&quot;&quot;</span>
    <span class="k">else</span>
      <span class="s">&#39;&#39;</span>
    <span class="nv">text =</span>
      <span class="s">&quot;&quot;&quot;</span>
<span class="s">      </span><span class="si">#{</span><span class="nx">p</span><span class="si">}</span><span class="s"></span>
<span class="s">      .</span><span class="si">#{</span><span class="nx">className</span><span class="si">}</span><span class="s"> \{</span>
<span class="s">        text-indent: 100%;</span>
<span class="s">        white-space: nowrap;</span>
<span class="s">        overflow: hidden;</span>
<span class="s">        position: absolute;</span>
<span class="s">        top: </span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">y</span><span class="si">}</span><span class="s">px;</span>
<span class="s">        left: </span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">x</span><span class="si">}</span><span class="s">px;</span>
<span class="s">        z-index: </span><span class="si">#{</span><span class="nx">z</span><span class="si">}</span><span class="s">;</span>
<span class="s">        width: </span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">width</span><span class="si">}</span><span class="s">px;</span>
<span class="s">        height: </span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">height</span><span class="si">}</span><span class="s">px;</span>
<span class="s">        background: url(</span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">url</span><span class="si">}</span><span class="s">) no-repeat scroll 0 0;</span>
<span class="s">      \}</span>
<span class="s">      &quot;&quot;&quot;</span>
    <span class="nx">cssText</span><span class="p">.</span><span class="nx">push</span> <span class="nx">text</span>
  <span class="nv">cssFile = </span><span class="k">new</span> <span class="nx">File</span> <span class="nx">saveFolder</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="s">&#39;style.css&#39;</span>
  <span class="nx">cssFile</span><span class="p">.</span><span class="nx">open</span> <span class="s">&#39;w&#39;</span>
  <span class="nv">cssFile.encoding = </span><span class="s">&#39;utf-8&#39;</span>
  <span class="nx">cssFile</span><span class="p">.</span><span class="nx">write</span> <span class="nx">cssText</span><span class="p">.</span><span class="nx">join</span> <span class="s">&#39;\n&#39;</span>
  <span class="nx">cssFile</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span>
  <span class="nv">htmlTags = </span><span class="p">[]</span>
  <span class="k">for</span> <span class="nx">layer</span><span class="p">,</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">structures</span>
    <span class="nv">z = </span><span class="nx">i</span> <span class="o">*</span> <span class="mi">10</span>
    <span class="nv">className = </span><span class="nx">layer</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\//g</span><span class="p">,</span> <span class="s">&#39;_&#39;</span><span class="p">).</span><span class="nx">replace</span> <span class="sr">/\.[a-z]+$/i</span><span class="p">,</span> <span class="s">&#39;&#39;</span>
    <span class="nv">p = </span><span class="k">if</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">text</span><span class="p">.</span><span class="nx">length</span>
      <span class="s">&#39;&lt;p&gt;&#39;</span> <span class="o">+</span> <span class="nx">layer</span><span class="p">.</span><span class="nx">text</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s">&#39;&lt;/p&gt;&lt;p&gt;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;&lt;/p&gt;&#39;</span>
    <span class="k">else</span>
      <span class="s">&#39;&#39;</span>
    <span class="nv">text = </span><span class="s">&quot;&quot;&quot;</span>
<span class="s">      &lt;div class=&quot;</span><span class="si">#{</span><span class="nx">className</span><span class="si">}</span><span class="s">&quot;&gt;</span>
<span class="s">        </span><span class="si">#{</span><span class="nx">p</span><span class="si">}</span><span class="s"></span>
<span class="s">        &lt;!-- &lt;img class=&quot;</span><span class="si">#{</span><span class="nx">className</span><span class="si">}</span><span class="s">&quot; src=&quot;</span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">url</span><span class="si">}</span><span class="s">&quot; alt=&quot;</span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="s">&quot; width=&quot;</span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">width</span><span class="si">}</span><span class="s">&quot; height=&quot;</span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">height</span><span class="si">}</span><span class="s">&quot;&gt; --&gt;</span>
<span class="s">        &lt;!-- &lt;div class=&quot;</span><span class="si">#{</span><span class="nx">className</span><span class="si">}</span><span class="s">&quot; data-src=&quot;</span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">url</span><span class="si">}</span><span class="s">&quot; data-width=&quot;</span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">width</span><span class="si">}</span><span class="s">&quot; data-height=&quot;</span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">height</span><span class="si">}</span><span class="s">&quot; data-x=&quot;</span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">x</span><span class="si">}</span><span class="s">&quot; data-y=&quot;</span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">y</span><span class="si">}</span><span class="s">&quot; data-z=&quot;</span><span class="si">#{</span><span class="nx">z</span><span class="si">}</span><span class="s">&quot;&gt;</span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="s">&lt;/div&gt; --&gt;</span>
<span class="s">      &lt;/div&gt;</span>
<span class="s">    &quot;&quot;&quot;</span>
    <span class="nx">htmlTags</span><span class="p">.</span><span class="nx">push</span> <span class="nx">text</span>
  <span class="nv">html = </span><span class="s">&quot;&quot;&quot;</span>
<span class="s">    &lt;!doctype html&gt;</span>
<span class="s">    &lt;html&gt;</span>
<span class="s">    &lt;head&gt;</span>
<span class="s">      &lt;meta charset=&quot;utf-8&quot;&gt;</span>
<span class="s">      &lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;&gt;</span>
<span class="s">    &lt;/haed&gt;</span>
<span class="s">    &lt;body&gt;</span>

<span class="s">    &lt;div id=&quot;wrapper&quot;&gt;</span>

<span class="s">    $</span>

<span class="s">    &lt;/div&gt;</span>

<span class="s">    &lt;/body&gt;</span>
<span class="s">    &lt;/html&gt;</span>
<span class="s">  &quot;&quot;&quot;</span>
  <span class="nv">htmlFile = </span><span class="k">new</span> <span class="nx">File</span> <span class="nx">saveFolder</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="s">&#39;index.html&#39;</span>
  <span class="nx">htmlFile</span><span class="p">.</span><span class="nx">open</span> <span class="s">&#39;w&#39;</span>
  <span class="nv">htmlFile.encoding = </span><span class="s">&#39;utf-8&#39;</span>
  <span class="nx">htmlFile</span><span class="p">.</span><span class="nx">write</span> <span class="nx">html</span><span class="p">.</span><span class="nx">replace</span> <span class="s">&#39;$&#39;</span><span class="p">,</span> <span class="nx">htmlTags</span><span class="p">.</span><span class="nx">reverse</span><span class="p">().</span><span class="nx">join</span> <span class="s">&#39;\n&#39;</span>
  <span class="nx">htmlFile</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span>
  <span class="k">return</span>

<span class="nv">outputJSON = </span><span class="nf">(structures) -&gt;</span>
  <span class="nv">outputText = </span><span class="p">[]</span>
  <span class="k">for</span> <span class="nx">layer</span><span class="p">,</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">structures</span>
    <span class="nv">z = </span><span class="nx">i</span> <span class="o">*</span> <span class="mi">10</span>
    <span class="nv">className = </span><span class="nx">layer</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\//g</span><span class="p">,</span> <span class="s">&#39;_&#39;</span><span class="p">).</span><span class="nx">replace</span> <span class="sr">/\.[a-z]+$/i</span><span class="p">,</span> <span class="s">&#39;&#39;</span>
    <span class="nv">text = </span><span class="s">&quot;&quot;&quot;</span>
<span class="s">      \{</span>
<span class="s">        &quot;name&quot;: &quot;</span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="s">&quot;,</span>
<span class="s">        &quot;className&quot;: &quot;</span><span class="si">#{</span><span class="nx">className</span><span class="si">}</span><span class="s">&quot;,</span>
<span class="s">        &quot;x&quot;: </span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">x</span><span class="si">}</span><span class="s">,</span>
<span class="s">        &quot;y&quot;: </span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">y</span><span class="si">}</span><span class="s">,</span>
<span class="s">        &quot;z&quot;: </span><span class="si">#{</span><span class="nx">z</span><span class="si">}</span><span class="s">,</span>
<span class="s">        &quot;width&quot;: </span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">width</span><span class="si">}</span><span class="s">,</span>
<span class="s">        &quot;height&quot;: </span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">height</span><span class="si">}</span><span class="s">,</span>
<span class="s">        &quot;url&quot;: &quot;</span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">url</span><span class="si">}</span><span class="s">&quot;</span>
<span class="s">      \}</span>
<span class="s">    &quot;&quot;&quot;</span>
    <span class="nx">outputText</span><span class="p">.</span><span class="nx">push</span> <span class="nx">text</span>
  <span class="nv">outputFile = </span><span class="k">new</span> <span class="nx">File</span> <span class="nx">saveFolder</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="s">&#39;structures.json&#39;</span>
  <span class="nx">outputFile</span><span class="p">.</span><span class="nx">open</span> <span class="s">&#39;w&#39;</span>
  <span class="nv">outputFile.encoding = </span><span class="s">&#39;utf-8&#39;</span>
  <span class="nx">outputFile</span><span class="p">.</span><span class="nx">write</span> <span class="s">&#39;[&#39;</span> <span class="o">+</span> <span class="nx">outputText</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s">&#39;,\n&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;]&#39;</span>
  <span class="nx">outputFile</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span>
  <span class="k">return</span>

<span class="nv">outputLESS = </span><span class="nf">(structures) -&gt;</span>
  <span class="nv">cssText = </span><span class="p">[]</span>
  <span class="k">for</span> <span class="nx">layer</span><span class="p">,</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">structures</span>
    <span class="nv">z = </span><span class="nx">i</span> <span class="o">*</span> <span class="mi">10</span>
    <span class="nv">className = </span><span class="nx">layer</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\//g</span><span class="p">,</span> <span class="s">&#39;_&#39;</span><span class="p">).</span><span class="nx">replace</span> <span class="sr">/\.[a-z]+$/i</span><span class="p">,</span> <span class="s">&#39;&#39;</span>
    <span class="nv">text =</span>
      <span class="s">&quot;&quot;&quot;</span>
<span class="s">      .</span><span class="si">#{</span><span class="nx">className</span><span class="si">}</span><span class="s"> \{</span>
<span class="s">        overflow: hidden;</span>
<span class="s">        position: absolute;</span>
<span class="s">        top: </span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">y</span><span class="si">}</span><span class="s">px;</span>
<span class="s">        left: </span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">x</span><span class="si">}</span><span class="s">px;</span>
<span class="s">        z-index: </span><span class="si">#{</span><span class="nx">z</span><span class="si">}</span><span class="s">;</span>
<span class="s">        width: </span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">width</span><span class="si">}</span><span class="s">px;</span>
<span class="s">        height: </span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">height</span><span class="si">}</span><span class="s">px;</span>
<span class="s">        background: url(</span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">url</span><span class="si">}</span><span class="s">) no-repeat scroll 0 0;</span>
<span class="s">      \}</span>
<span class="s">      &quot;&quot;&quot;</span>
    <span class="nx">cssText</span><span class="p">.</span><span class="nx">push</span> <span class="nx">text</span>
  <span class="nv">lessFile = </span><span class="k">new</span> <span class="nx">File</span> <span class="nx">saveFolder</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="s">&#39;position.less&#39;</span>
  <span class="nx">lessFile</span><span class="p">.</span><span class="nx">open</span> <span class="s">&#39;w&#39;</span>
  <span class="nv">lessFile.encoding = </span><span class="s">&#39;utf-8&#39;</span>
  <span class="nx">lessFile</span><span class="p">.</span><span class="nx">write</span> <span class="nx">cssText</span><span class="p">.</span><span class="nx">join</span> <span class="s">&#39;\n&#39;</span>
  <span class="nx">lessFile</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span>
  <span class="nv">scssFile = </span><span class="k">new</span> <span class="nx">File</span> <span class="nx">saveFolder</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="s">&#39;_position.scss&#39;</span>
  <span class="nx">lessFile</span><span class="p">.</span><span class="nx">copy</span> <span class="nx">scssFile</span>
  <span class="nv">cssText = </span><span class="p">[]</span>
  <span class="k">for</span> <span class="nx">layer</span><span class="p">,</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">structures</span>
    <span class="nv">z = </span><span class="nx">i</span> <span class="o">*</span> <span class="mi">10</span>
    <span class="nv">className = </span><span class="nx">layer</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\//g</span><span class="p">,</span> <span class="s">&#39;_&#39;</span><span class="p">).</span><span class="nx">replace</span> <span class="sr">/\.[a-z]+$/i</span><span class="p">,</span> <span class="s">&#39;&#39;</span>
    <span class="nv">text =</span>
      <span class="s">&quot;&quot;&quot;</span>
<span class="s">      .</span><span class="si">#{</span><span class="nx">className</span><span class="si">}</span><span class="s"></span>
<span class="s">        overflow: hidden</span>
<span class="s">        position: absolute</span>
<span class="s">        top: </span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">y</span><span class="si">}</span><span class="s">px</span>
<span class="s">        left: </span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">x</span><span class="si">}</span><span class="s">px</span>
<span class="s">        z-index: </span><span class="si">#{</span><span class="nx">z</span><span class="si">}</span><span class="s"></span>
<span class="s">        width: </span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">width</span><span class="si">}</span><span class="s">px</span>
<span class="s">        height: </span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">height</span><span class="si">}</span><span class="s">px</span>
<span class="s">        background: url(</span><span class="si">#{</span><span class="nx">layer</span><span class="p">.</span><span class="nx">url</span><span class="si">}</span><span class="s">) no-repeat scroll 0 0</span>
<span class="s">      &quot;&quot;&quot;</span>
    <span class="nx">cssText</span><span class="p">.</span><span class="nx">push</span> <span class="nx">text</span>
  <span class="nv">sassFile = </span><span class="k">new</span> <span class="nx">File</span> <span class="nx">saveFolder</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="s">&#39;_position.sass&#39;</span>
  <span class="nx">sassFile</span><span class="p">.</span><span class="nx">open</span> <span class="s">&#39;w&#39;</span>
  <span class="nv">sassFile.encoding = </span><span class="s">&#39;utf-8&#39;</span>
  <span class="nx">sassFile</span><span class="p">.</span><span class="nx">write</span> <span class="nx">cssText</span><span class="p">.</span><span class="nx">join</span> <span class="s">&#39;\n&#39;</span>
  <span class="nx">sassFile</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span>
  <span class="k">return</span>

<span class="nv">outputJQUERY = </span><span class="nf">(structures) -&gt;</span>
  <span class="nv">jsvText = </span><span class="p">[]</span>
  <span class="nv">jsjText = </span><span class="p">[]</span>
  <span class="k">for</span> <span class="nx">layer</span><span class="p">,</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">structures</span>
    <span class="nv">z = </span><span class="nx">i</span> <span class="o">*</span> <span class="mi">10</span>
    <span class="nv">className = </span><span class="nx">layer</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\//g</span><span class="p">,</span> <span class="s">&#39;_&#39;</span><span class="p">).</span><span class="nx">replace</span> <span class="sr">/\.[a-z]+$/i</span><span class="p">,</span> <span class="s">&#39;&#39;</span>
    <span class="nv">variableName = </span><span class="nx">className</span><span class="p">.</span><span class="nx">replace</span> <span class="sr">/_([a-z])/g</span><span class="p">,</span> <span class="nf">($0, $1) -&gt;</span> <span class="nx">$1</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span>
    <span class="nv">vtext = </span><span class="s">&quot;$</span><span class="si">#{</span><span class="nx">variableName</span><span class="si">}</span><span class="s">&quot;</span>
    <span class="nx">jsvText</span><span class="p">.</span><span class="nx">push</span> <span class="nx">vtext</span>
    <span class="nv">jtext = </span><span class="s">&quot;$</span><span class="si">#{</span><span class="nx">variableName</span><span class="si">}</span><span class="s"> = $(&#39;.</span><span class="si">#{</span><span class="nx">className</span><span class="si">}</span><span class="s">&#39;)&quot;</span>
    <span class="nx">jsjText</span><span class="p">.</span><span class="nx">push</span> <span class="nx">jtext</span>
  <span class="nv">jsFile = </span><span class="k">new</span> <span class="nx">File</span> <span class="nx">saveFolder</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="s">&#39;position.js&#39;</span>
  <span class="nx">jsFile</span><span class="p">.</span><span class="nx">open</span> <span class="s">&#39;w&#39;</span>
  <span class="nv">jsFile.encoding = </span><span class="s">&#39;utf-8&#39;</span>
  <span class="nx">jsFile</span><span class="p">.</span><span class="nx">writeln</span> <span class="s">&#39;var\n\t&#39;</span> <span class="o">+</span> <span class="nx">jsvText</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s">&#39;,\n\t&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;;\n\n&#39;</span>
  <span class="nx">jsFile</span><span class="p">.</span><span class="nx">write</span> <span class="nx">jsjText</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s">&#39;;\n&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;;&#39;</span>
  <span class="nx">jsFile</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span>
  <span class="nv">cfvText = </span><span class="p">[]</span>
  <span class="nv">cfjText = </span><span class="p">[]</span>
  <span class="k">for</span> <span class="nx">layer</span><span class="p">,</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">structures</span>
    <span class="nv">z = </span><span class="nx">i</span> <span class="o">*</span> <span class="mi">10</span>
    <span class="nv">className = </span><span class="nx">layer</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\//g</span><span class="p">,</span> <span class="s">&#39;_&#39;</span><span class="p">).</span><span class="nx">replace</span> <span class="sr">/\.[a-z]+$/i</span><span class="p">,</span> <span class="s">&#39;&#39;</span>
    <span class="nv">variableName = </span><span class="nx">className</span><span class="p">.</span><span class="nx">replace</span> <span class="sr">/_([a-z])/g</span><span class="p">,</span> <span class="nf">($0, $1) -&gt;</span> <span class="nx">$1</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()</span>
    <span class="nv">vtext = </span><span class="s">&quot;$</span><span class="si">#{</span><span class="nx">variableName</span><span class="si">}</span><span class="s">&quot;</span>
    <span class="nx">cfvText</span><span class="p">.</span><span class="nx">push</span> <span class="nx">vtext</span>
    <span class="nv">jtext = </span><span class="s">&quot;$</span><span class="si">#{</span><span class="nx">variableName</span><span class="si">}</span><span class="s"> = $ &#39;.</span><span class="si">#{</span><span class="nx">className</span><span class="si">}</span><span class="s">&#39;&quot;</span>
    <span class="nx">cfjText</span><span class="p">.</span><span class="nx">push</span> <span class="nx">jtext</span>
  <span class="nv">cfFile = </span><span class="k">new</span> <span class="nx">File</span> <span class="nx">saveFolder</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="s">&#39;position.coffee&#39;</span>
  <span class="nx">cfFile</span><span class="p">.</span><span class="nx">open</span> <span class="s">&#39;w&#39;</span>
  <span class="nv">cfFile.encoding = </span><span class="s">&#39;utf-8&#39;</span>
  <span class="nx">cfFile</span><span class="p">.</span><span class="nx">writeln</span> <span class="nx">cfvText</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s">&#39; =\n&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; = undefined\n\n&#39;</span>
  <span class="nx">cfFile</span><span class="p">.</span><span class="nx">write</span> <span class="nx">cfjText</span><span class="p">.</span><span class="nx">join</span> <span class="s">&#39;\n&#39;</span>
  <span class="nx">cfFile</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span>
  <span class="k">return</span>

</pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>wrapper {</p>             </td>             <td class="code">               <div class="highlight"><pre>undefined</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 